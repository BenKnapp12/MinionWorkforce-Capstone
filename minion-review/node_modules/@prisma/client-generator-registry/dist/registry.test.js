"use strict";
var import_vitest = require("vitest");
var import_registry = require("./registry");
(0, import_vitest.describe)("GeneratorRegistry", () => {
  const createMockGenerator = (name) => ({
    name,
    generate: import_vitest.vi.fn(),
    getManifest: import_vitest.vi.fn()
  });
  (0, import_vitest.it)("should add a generator to the registry", () => {
    const registry = new import_registry.GeneratorRegistry();
    const mockGenerator = createMockGenerator("test-generator");
    registry.add(mockGenerator);
    const internal = registry.toInternal();
    (0, import_vitest.expect)(internal).toHaveProperty("test-generator");
    (0, import_vitest.expect)(internal["test-generator"]).toEqual({
      type: "in-process",
      generator: mockGenerator
    });
  });
  (0, import_vitest.it)("should override an existing generator with the same name", () => {
    const registry = new import_registry.GeneratorRegistry();
    const firstGenerator = createMockGenerator("duplicate-name");
    const secondGenerator = createMockGenerator("duplicate-name");
    registry.add(firstGenerator);
    registry.add(secondGenerator);
    const internal = registry.toInternal();
    (0, import_vitest.expect)(internal["duplicate-name"].generator).toBe(
      secondGenerator
    );
  });
  (0, import_vitest.it)("should convert to internal registry format correctly", () => {
    const registry = new import_registry.GeneratorRegistry();
    const generator1 = createMockGenerator("generator-1");
    const generator2 = createMockGenerator("generator-2");
    registry.add(generator1);
    registry.add(generator2);
    const internal = registry.toInternal();
    (0, import_vitest.expect)(Object.keys(internal)).toHaveLength(2);
    (0, import_vitest.expect)(internal).toEqual({
      "generator-1": {
        type: "in-process",
        generator: generator1
      },
      "generator-2": {
        type: "in-process",
        generator: generator2
      }
    });
  });
  (0, import_vitest.it)("should return an empty object when no generators are added", () => {
    const registry = new import_registry.GeneratorRegistry();
    const internal = registry.toInternal();
    (0, import_vitest.expect)(internal).toEqual({});
    (0, import_vitest.expect)(Object.keys(internal)).toHaveLength(0);
  });
});
